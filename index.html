<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>자유게시판</title>
<style>
/* 기존 스타일 그대로 유지 */
</style>
</head>
<body>
<header>
  <h1>나의 게시판</h1>
  <img src="그림1.png" alt="그림1">
</header>

<div class="main-box">
  <div class="speech-bubble">어떤 건의사항이 있으신가요?</div>
  <div class="buttons">
    <button onclick="showWriteForm()">글쓰기</button>
    <button onclick="viewMyPost()">조회</button>
  </div>
  <img src="그림2.png" alt="그림2" class="main-image">
</div>

<div id="forms"></div>
<div id="posts"></div>

<!-- 관리자 버튼 하단에 하나만 -->
<div class="admin-link">
  <button onclick="goAdmin()">관리자 페이지</button>
</div>

<footer>
  <p style="color:#888; font-size:36px;">Powered by 나의 게시판</p>
</footer>

<script>
let posts = JSON.parse(localStorage.getItem("posts") || "[]");

// 글쓰기
function showWriteForm(){
  document.getElementById("forms").innerHTML=`
    <h3>글쓰기</h3>
    <textarea id="content" placeholder="내용을 입력하세요"></textarea><br>
    <input type="password" id="pw" placeholder="비밀번호(4자리)" maxlength="4"><br>
    <button onclick="savePost()">입력완료</button>
  `;
}

function savePost(){
  const content=document.getElementById("content").value.trim();
  const pw=document.getElementById("pw").value.trim();
  if(!content||pw.length!==4){alert("내용과 4자리 비밀번호를 입력하세요.");return;}
  posts.push({id:Date.now(), content, pw, views:0, comments:[]});
  localStorage.setItem("posts", JSON.stringify(posts));
  alert("글이 등록되었습니다.");
  document.getElementById("forms").innerHTML="";
}

// 조회 버튼 → 비밀번호 프롬프트 → 맞으면 view.html 이동
function viewMyPost(){
  const inputPw = prompt("작성 시 입력한 비밀번호를 입력하세요:");
  if(!inputPw) return;
  if(inputPw.length!==4){alert("비밀번호는 4자리입니다."); return;}
  const myPosts = posts.filter(p=>p.pw===inputPw);
  if(myPosts.length===0){alert("해당 비밀번호로 작성된 글이 없습니다."); return;}
  sessionStorage.setItem("viewPw", inputPw);
  window.location.href="view.html";
}

// 관리자 버튼 → 프롬프트 → 맞으면 admin.html
function goAdmin(){
  const inputPw = prompt("관리자 비밀번호를 입력하세요:");
  if(inputPw==="dobong09!"){
    sessionStorage.setItem("adminAuth","true"); // 키 이름 변경 → admin.html과 동일하게
    window.location.href="admin.html";
  }else{
    alert("비밀번호가 올바르지 않습니다.");
  }
}
</script>
</body>
</html>
