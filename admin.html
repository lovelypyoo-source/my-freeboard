<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>관리자 페이지</title>
<style>
body { font-family: Arial,sans-serif; padding:20px; background:#f9f9f9; }
h1 { text-align:center; margin-bottom:30px; }
table { width:100%; border-collapse: collapse; }
th, td { border:1px solid #ccc; padding:10px; text-align:left; vertical-align:top; }
th { background:#f0f0f0; font-size:18px; }
td textarea { width:100%; height:120px; font-size:16px; }
td input[type=text] { width:80%; padding:5px; font-size:14px; }
td button { padding:6px 12px; font-size:14px; margin:2px; cursor:pointer; }
.comments { margin-top:5px; padding-left:10px; border-left:2px solid #ccc; }
.comments p { margin:2px 0; }
</style>
</head>
<body>
<h1>관리자 페이지 - 전체 게시판</h1>

<table id="postsTable">
  <thead>
    <tr>
      <th>글 번호</th>
      <th>내용</th>
      <th>조회수</th>
      <th>댓글</th>
      <th>관리</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>

<script>
// 로컬스토리지에서 글 가져오기
let posts = JSON.parse(localStorage.getItem("posts") || "[]");

// 게시판 렌더링
function renderPosts() {
  const tbody = document.querySelector("#postsTable tbody");
  tbody.innerHTML = "";

  posts.forEach((p, index) => {
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${index+1}</td>
      <td>
        <textarea id="editContent_${p.id}">${p.content}</textarea>
      </td>
      <td>${p.views}</td>
      <td>
        <div class="comments">
          ${p.comments.map(c=>`<p>- ${c}</p>`).join('')}
        </div>
        <input type="text" id="commentInput_${p.id}" placeholder="댓글 작성">
        <button onclick="addComment('${p.id}')">댓글 등록</button>
      </td>
      <td>
        <button onclick="savePost('${p.id}')">저장</button>
        <button onclick="deletePost('${p.id}')">삭제</button>
      </td>
    `;
    tbody.appendChild(tr);
  });
}

// 댓글 등록
function addComment(id) {
  const input = document.getElementById(`commentInput_${id}`);
  const post = posts.find(p=>p.id==id);
  if(!post || !input.value.trim()) return;
  post.comments.push(input.value.trim());
  savePosts();
  input.value="";
  renderPosts();
}

// 글 저장
function savePost(id) {
  const post = posts.find(p=>p.id==id);
  post.content = document.getElementById(`editContent_${id}`).value;
  savePosts();
  alert("저장 완료");
  renderPosts();
}

// 글 삭제
function deletePost(id) {
  if(!confirm("삭제하시겠습니까?")) return;
  posts = posts.filter(p=>p.id!=id);
  savePosts();
  renderPosts();
}

// 로컬스토리지에 저장
function savePosts() {
  localStorage.setItem("posts", JSON.stringify(posts));
}

// 초기 렌더링
renderPosts();
</script>
</body>
</html>
