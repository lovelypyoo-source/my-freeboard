<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>관리자 페이지</title>
<style>
body { font-family: Arial, sans-serif; padding:20px; background:#f9f9f9; }
h1 { text-align:center; margin-bottom:30px; }
.post-card { background:#fff; padding:15px; margin-bottom:20px; border-radius:10px; box-shadow:0 2px 5px rgba(0,0,0,0.1);}
textarea { width:100%; height:60px; }
button { margin-top:5px; padding:5px 10px; border:none; border-radius:5px; background:#28a745; color:white; cursor:pointer;}
button:hover { background:#1e7e34; }
</style>
</head>
<body>
  <h1>관리자 페이지</h1>
  <div id="allPosts"></div>

<script>
if(sessionStorage.getItem("isAdmin")!=="true"){
  alert("관리자 인증 후 이용하세요.");
  window.location.href="index.html";
}

let posts=JSON.parse(localStorage.getItem("posts")||"[]");
renderAllPosts();

function renderAllPosts(){
  const container=document.getElementById("allPosts");
  container.innerHTML="";
  posts.forEach((post,i)=>{
    const div=document.createElement("div");
    div.className="post-card";
    div.innerHTML=`
      <p><strong>글내용:</strong></p>
      <textarea id="content${i}">${post.content}</textarea><br>
      <p>조회수: ${post.views}</p>
      <h4>댓글</h4>
      <div id="comments${i}">
        ${post.comments.map((c,ci)=>`
          <p>${c} <button onclick="deleteComment(${i},${ci})">삭제</button></p>
        `).join("") || "<p>댓글 없음</p>"}
      </div>
      <textarea id="newComment${i}" placeholder="댓글 입력"></textarea><br>
      <button onclick="savePost(${i})">수정</button>
      <button onclick="addComment(${i})">댓글 추가</button>
    `;
    container.appendChild(div);
  });
}

function savePost(i){
  posts[i].content=document.getElementById("content"+i).value;
  localStorage.setItem("posts",JSON.stringify(posts));
  alert("수정 완료");
}

function addComment(i){
  const comment=document.getElementById("newComment"+i).value.trim();
  if(!comment) return;
  posts[i].comments.push(comment);
  localStorage.setItem("posts",JSON.stringify(posts));
  renderAllPosts();
}

function deleteComment(i,ci){
  posts[i].comments.splice(ci,1);
  localStorage.setItem("posts",JSON.stringify(posts));
  renderAllPosts();
}
</script>
</body>
</html>
