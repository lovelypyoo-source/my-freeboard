<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>관리자 페이지</title>
<style>
body { font-family: Arial,sans-serif; padding:20px; background:#f9f9f9; }
h1 { text-align:center; margin-bottom:30px; }
.post { background:#fff; padding:15px; margin-bottom:20px; border-radius:10px; max-width:600px; margin:auto; box-shadow:0 2px 5px rgba(0,0,0,0.1);}
.comments { margin-top:10px; padding-top:10px; border-top:1px solid #ddd; }
textarea { width:100%; height:50px; margin-top:5px; }
button { margin-top:5px; }
</style>
</head>
<body>
  <h1>관리자 페이지</h1>
  <div id="posts"></div>

<script>
if(sessionStorage.getItem("isAdmin")!=="true"){
  alert("관리자 인증 후 이용하세요.");
  window.location.href="index.html";
}

let posts=JSON.parse(localStorage.getItem("posts")||"[]");
renderPosts();

function renderPosts(){
  const postsDiv=document.getElementById("posts");
  postsDiv.innerHTML="";
  posts.forEach((post,idx)=>{
    const div=document.createElement("div");
    div.className="post";
    div.innerHTML=`
      <p>${post.content}</p>
      <p>조회수: ${post.views}</p>
      <div class="comments">
        <h4>댓글</h4>
        ${post.comments.map((c,i)=>`
          <p>- ${c} <button onclick="editComment(${idx},${i})">수정</button></p>
        `).join("") || "<p>댓글 없음</p>"}
        <textarea id="cmt-${idx}" placeholder="댓글 입력"></textarea>
        <button onclick="addComment(${idx})">댓글 달기</button>
      </div>
    `;
    postsDiv.appendChild(div);
  });
}

function addComment(idx){
  const input=document.getElementById("cmt-"+idx);
  const txt=input.value.trim();
  if(!txt){ alert("댓글 내용을 입력하세요."); return; }
  posts[idx].comments.push(txt);
  localStorage.setItem("posts",JSON.stringify(posts));
  renderPosts();
}

function editComment(postIdx,cmtIdx){
  const newTxt=prompt("댓글 수정:",posts[postIdx].comments[cmtIdx]);
  if(newTxt!==null){
    posts[postIdx].comments[cmtIdx]=newTxt.trim();
    localStorage.setItem("posts",JSON.stringify(posts));
    renderPosts();
  }
}
</script>
</body>
</html>
